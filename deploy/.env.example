# =============================================================================
# MTChat Production Environment Variables
# Copy to .env and modify ALL values before deploying!
# =============================================================================

# --- PostgreSQL ---
POSTGRES_USER=mtchat
POSTGRES_PASSWORD=CHANGE_ME_postgres_secure_password
POSTGRES_DB=mtchat

# --- Redis ---
# No additional config needed for default setup

# --- MinIO (S3-compatible storage) ---
MINIO_ROOT_USER=mtchat-admin
MINIO_ROOT_PASSWORD=CHANGE_ME_minio_secure_password

# --- MTChat Backend ---

# Database connection (must match PostgreSQL settings above)
DATABASE_URL=postgres://${POSTGRES_USER}:${POSTGRES_PASSWORD}@postgres:5432/${POSTGRES_DB}

# Redis connection
REDIS_URL=redis://redis:6379

# JWT secret for user token validation (min 32 characters)
JWT_SECRET=CHANGE_ME_generate_a_random_string_at_least_32_chars

# Admin API token for Management API authentication
ADMIN_API_TOKEN=CHANGE_ME_generate_a_secure_admin_token

# Logging level
RUST_LOG=multitenancy_chat_api=info,tower_http=info

# Server port (inside container)
PORT=8080

# --- S3 / MinIO Configuration ---
S3_ENDPOINT=http://minio:9000
# Public endpoint for presigned URLs (used by browser to upload/download files)
# Set to your public-facing URL for MinIO or S3-compatible storage
S3_PUBLIC_ENDPOINT=https://s3.example.com
S3_BUCKET=mtchat-attachments
S3_ACCESS_KEY_ID=${MINIO_ROOT_USER}
S3_SECRET_ACCESS_KEY=${MINIO_ROOT_PASSWORD}
S3_REGION=us-east-1
# Presigned URL expiry times in seconds
S3_PRESIGN_UPLOAD_EXPIRY=300
S3_PRESIGN_DOWNLOAD_EXPIRY=3600

# --- Sentry (optional) ---
SENTRY_DSN=

# --- Outgoing Webhooks (optional) ---
WEBHOOK_URL=
WEBHOOK_SECRET=

# --- Smart Notifications (via job queue, requires Redis) ---
# Delay before sending notification webhook (0 = instant, default: 30)
NOTIFICATION_DELAY_SECS=30
# Concurrency for notification workers (default: 2)
NOTIFICATION_CONCURRENCY=2

# --- Auto-Archive (via job queue, requires Redis) ---
# Cron schedule for auto-archive job (default: every 5 minutes)
ARCHIVE_CRON=0 */5 * * * *
# Seconds of inactivity before auto-archive (default: 259200 = 3 days)
ARCHIVE_AFTER_SECS=259200
